<html>
<head>
  <title>PostHelper - Notifications</title>
  <meta charset="utf-8">
  <link rel="stylesheet" type="text/css" href="print_layout.css">
</head>
<body id="main">
<script type="text/javascript">
  var adrList = window.data;
  //console.log(adrList.length);
  var body = document.getElementById('main');
  var header = "<img src=\"logo.png\" class=\"logo\">";
  var info = [
    "<p>простой мелкий пакет</p>",
    "<p><i>", global.config.postAddress, "</i></p>"
  ].join("");
  var footer = [
    "<div class=\"footer\">", 
    "Для получения данного отправления Вам необходимо только предъявить документ, удостоверяющий личность.<br>", 
    "Заполнять оборотную сторону извещения <b><u>не требуется</u></b>.",
    "</div>"
  ].join("");

  function createPage(l4) {
    var page = document.createElement('page');
    page.setAttribute('size', 'A4');
    var table = document.createElement('table');
    table.setAttribute('style','width: 100%; height: 100%;');
    body.appendChild(page);
    page.appendChild(table);
    var tr1 = document.createElement('tr');
    var tr2 = document.createElement('tr');
    table.appendChild(tr1);
    table.appendChild(tr2);
    var td1 = document.createElement('td');
    var td2 = document.createElement('td');
    var td3 = document.createElement('td');
    var td4 = document.createElement('td');
    td1.innerHTML = [
      header,
      l4[0][3], 
      "<h2>", l4[0][0], "</h2>", 
      "<h3>", l4[0][1], "</h3>", 
      "<p>", l4[0][2], "</p>", 
      info, 
      footer
    ].join("");
    td2.innerHTML = [
      header, 
      l4[1][3], 
      "<h2>", l4[1][0], "</h2>", 
      "<h3>", l4[1][1], "</h3>", 
      "<p>", l4[1][2], "</p>", 
      info, 
      footer
    ].join("");
    td3.innerHTML = [
      header, 
      l4[2][3], 
      "<h2>", l4[2][0], "</h2>", 
      "<h3>", l4[2][1], "</h3>", 
      "<p>", l4[2][2], "</p>", 
      info, 
      footer
    ].join("");
    td4.innerHTML = [
      header, 
      l4[3][3], 
      "<h2>", l4[3][0], "</h2>", 
      "<h3>", l4[3][1], "</h3>", 
      "<p>", l4[3][2], "</p>", 
      info, 
      footer
    ].join("");
    tr1.appendChild(td1);
    tr1.appendChild(td2);
    tr2.appendChild(td3);
    tr2.appendChild(td4);
  }
  var c = 0;
  while (c < adrList.length) {
    createPage(adrList.slice(c, c + 4));
    c += 4;
  }
  window.print();
</script>
<script>
  var gui = require('nw.gui');
  onload = function() {
    gui.Window.get().show();
  }
</script>
</body>
</html>
